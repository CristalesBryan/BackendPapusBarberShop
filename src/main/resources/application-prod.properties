# ===========================================
# CONFIGURACIÓN DE PRODUCCIÓN PARA RAILWAY
# PAPUS BARBERSHOP
# ===========================================
# Este archivo se carga automáticamente cuando:
# spring.profiles.active=prod
# O cuando se ejecuta con: -Dspring.profiles.active=prod
#
# IMPORTANTE: Esta configuración está diseñada SOLO para Railway.
# No incluye valores por defecto para localhost.

# ==================== CONFIGURACIÓN DEL SERVIDOR ====================
# Puerto del servidor (Railway proporciona la variable PORT automáticamente)
server.port=${PORT}

# ==================== CONFIGURACIÓN DE BASE DE DATOS ====================
# Railway proporciona DATABASE_URL en formato: postgresql://user:pass@host:port/db
# DatabaseConfig.java parsea automáticamente esta URL y configura HikariPool
# Las variables PGUSER y PGPASSWORD son opcionales si DATABASE_URL contiene credenciales
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${PGUSER:}
spring.datasource.password=${PGPASSWORD:}
spring.datasource.driver-class-name=org.postgresql.Driver

# ==================== CONFIGURACIÓN DE POOL DE CONEXIONES HIKARI ====================
# Configuración optimizada para producción en Railway
# DatabaseConfig.java configura estos valores programáticamente, pero estos son los defaults
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.pool-name=PapusBarberShopPool-Prod
spring.datasource.hikari.leak-detection-threshold=60000

# ==================== CONFIGURACIÓN JPA/HIBERNATE ====================
# En producción, NO usar 'update', usar 'validate' o 'none'
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.show-sql=false

# ==================== CONFIGURACIÓN DE LOGGING ====================
# Logging optimizado para producción (menos verboso)
logging.level.com.papusbarbershop=INFO
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# Logs DEBUG de HikariCP para validar la conexión en producción
logging.level.com.zaxxer.hikari=DEBUG
logging.level.com.zaxxer.hikari.HikariConfig=DEBUG
logging.level.com.zaxxer.hikari.pool.HikariPool=DEBUG

# ==================== CONFIGURACIÓN DE VALIDACIÓN ====================
# En producción, ser más estricto con las validaciones
spring.jackson.deserialization.fail-on-unknown-properties=true

# ==================== CONFIGURACIÓN DE SEGURIDAD ====================
# Deshabilitar endpoints de desarrollo en producción
# (Asegúrate de que /admin/reset-admin-password esté protegido o deshabilitado)

# ==================== CONFIGURACIÓN JWT ====================
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:86400000}

# ==================== CONFIGURACIÓN DE ACTUATOR ====================
# Spring Boot Actuator para health checks y monitoreo
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=when-authorized
management.health.db.enabled=true
